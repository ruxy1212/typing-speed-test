'use client';

import { motion } from "motion/react";

// Animated path component that draws in
const AnimatedPath = ({ 
  d, 
  fill, 
  duration, 
  delay = 0 
}: { 
  d: string; 
  fill: string; 
  duration: number; 
  delay?: number;
}) => (
  <motion.path
    d={d}
    fill={fill}
    initial={{ pathLength: 0, fillOpacity: 0 }}
    animate={{ pathLength: 1, fillOpacity: 1 }}
    transition={{
      pathLength: { duration, delay, ease: "easeInOut" },
      fillOpacity: { duration: duration * 0.3, delay: delay + duration * 0.7, ease: "easeIn" }
    }}
    stroke={fill}
    strokeWidth={0.5}
  />
);

// Star 1 - Yellow 4-pointed star (74x74)
function AnimatedStar1({ className }: { className?: string }) {
  return (
    <motion.svg
      xmlns="http://www.w3.org/2000/svg"
      width="74"
      height="74"
      fill="none"
      viewBox="0 0 74 74"
      className={className}
      initial={{ opacity: 0, scale: 0.5 }}
      animate={{ opacity: 1, scale: 1 }}
      transition={{ duration: 0.3, ease: "easeOut" }}
    >
      <AnimatedPath
        d="M37 74c-1.071-35.053-1.947-35.923-37-37 35.053-1.071 35.923-1.947 37-37 1.071 35.053 1.947 35.923 37 37-35.053 1.077-35.923 1.936-37 37"
        fill="#f4dc73"
        duration={2}
      />
    </motion.svg>
  );
}

// Star 2 - Red 8-pointed star (32x32)
function AnimatedStar2({ className }: { className?: string }) {
  return (
    <motion.svg
      xmlns="http://www.w3.org/2000/svg"
      width="32"
      height="32"
      fill="none"
      viewBox="0 0 32 32"
      className={className}
      initial={{ opacity: 0, scale: 0.5 }}
      animate={{ opacity: 1, scale: 1 }}
      transition={{ duration: 0.3, ease: "easeOut" }}
    >
      <AnimatedPath
        d="M17.143 0h-2.286v13.24L5.494 3.879 3.878 5.494l9.363 9.363H0v2.286h13.24l-9.362 9.363 1.616 1.616 9.363-9.363V32h2.286V18.759l9.363 9.363 1.616-1.616-9.363-9.363H32v-2.286H18.759l9.363-9.363-1.616-1.616-9.363 9.363z"
        fill="#d64d5b"
        duration={2}
      />
    </motion.svg>
  );
}

// Confetti paths data - extracted from the SVG
const confettiPaths = [
  { d: "m1048.57 82.375-5.69-.204-.12 9.471 5.69.204z", fill: "#177dff" },
  { d: "m1077.04 147.919-.45-6.467-9.46-1.147.45 6.467z", fill: "#4dd67b" },
  { d: "m1382.52 271.437 9.22-3.511-2.46-10.027-9.22 3.511z", fill: "#177dff" },
  { d: "m105.313 338.81 5.297-4.495-13.994-13.569-5.298 4.494zM315.904 99.609l3.306-7.172-13.619-6.678-3.306 7.172zM1195.79 215.239l-1.49-4.959-8.87 2.126 1.49 4.959zM1256.84 224.167l2.75-6.398-10.62-6.96-2.75 6.398z", fill: "#f4dc73" },
  { d: "m313.525 49.753-4.47-3.316-5.882 7.696 4.47 3.317zM675.417 113.437l-8.563-3.113-4.59 22.304 8.563 3.113zM1168.81 164.553l-7.18-.881-.72 13.63 7.18.881zM761.105 99.503l5.045-2.15-1.412-6.59-5.046 2.15z", fill: "#177dff" },
  { d: "m1269.78 207.824 6.52-3.043-3.04-6.525-6.52 3.043zM1372.24 239.404l8.74-1.054.4-11.441-8.74 1.053zM35.82 230.132l5.918-3.631-6.076-8.797-5.92 3.631z", fill: "#4dd67b" },
  { d: "m46.496 57.274 4.974-3.072-11.026-14.765-4.974 3.072zM1204.41 264.172l-3.8-8.066-18.84 7.482 3.8 8.067z", fill: "#d64d5b" },
  { d: "m851.853 101.738 1.8-7.395-19.831-7.226-1.801 7.395z", fill: "#4dd67b" },
  { d: "m821.759 290.352 5.182-6.265-14.095-11.569-5.182 6.265z", fill: "#177dff" },
  { d: "m1276.93 277.565 6.43-2.016-7.87-16.867-6.43 2.016zM1288.46 320.028l-1.37-6.488-7.94-.139 1.37 6.488z", fill: "#4dd67b" },
  { d: "m407.223 321.596 4.971-2.704-2.259-6.801-4.972 2.704zM292.077 200.288l-.154-5.206-12.611-2.12.154 5.206z", fill: "#f4dc73" },
  { d: "m1342.85 280.018-1.04-5.805-11.87 1.514 1.04 5.806z", fill: "#177dff" },
  { d: "m119.537 202.441-.46-9.439-15.666.837.459 9.439z", fill: "#f4dc73" },
  { d: "m744.714 288.845 2.466-7.939-8.981-1.151-2.466 7.938z", fill: "#4dd67b" },
  { d: "m1006.68 236.055 6.85-2.466-6.45-19.647-6.84 2.466z", fill: "#d64d5b" },
  { d: "m306.136 211.203 5.953-4.878-9.237-12.46-5.953 4.878zM1023.79 301.106l-5.79-7.813-13.9 4.888 5.79 7.814zM597.027 65.857l-4.267-8.127-10.692 4.42 4.267 8.127z", fill: "#4dd67b" },
  { d: "m818.795 295.479-5.125-2.366-2.504 10.173 5.125 2.366z", fill: "#d64d5b" },
  { d: "m939.562 185.375-4.969-1.134-1.252 7.016 4.969 1.134z", fill: "#177dff" },
  { d: "m566.667 263.215-4.975-9.414-10.646 4.235 4.975 9.415z", fill: "#4dd67b" },
  { d: "m659.092 133.791-4.026-3.315-3.033 3.813 4.025 3.315z", fill: "#177dff" },
  { d: "m903.142 210.875-2.789-3.64-8.573 7.029 2.789 3.639z", fill: "#4dd67b" },
  { d: "m231.212 92.35 4.713-3.307-5.36-7.678-4.713 3.308zM1196.36 239.793l-6.83-3.447-1.4 6.129 6.83 3.447z", fill: "#177dff" },
  { d: "m767.602 215.481 2.341-7.872-17.456-2.197-2.342 7.872z", fill: "#4dd67b" },
  { d: "m1234.77 213.07.85-8.914-22.78-6.907-.85 8.914z", fill: "#d64d5b" },
  { d: "m421.71 304.675 1.588-5.1-12.666-.458-1.588 5.1z", fill: "#177dff" },
  { d: "m230.435 108.763 7.208-2.21-12.557-22.905-7.207 2.21z", fill: "#d64d5b" },
  { d: "m748.347 198.645 8.66-1.211-.001-15.804-8.66 1.211z", fill: "#4dd67b" },
  { d: "m441.487 236.876 2.282-3.133-9.934-8.625-2.282 3.133z", fill: "#177dff" },
  { d: "m92.39 285-6.226-4.403-4.168 7.878 6.225 4.402z", fill: "#f4dc73" },
  { d: "m263.951 260.74-5.448-2.75-2.918 11.467 5.448 2.75zM525.46 159.731l.3-5.732-7.196-.753-.3 5.732zM807.887 17.118l-6.599-5.34-5.995 7.405 6.598 5.34z", fill: "#d64d5b" },
  { d: "m581.108 100.093-2.09-8.64-16.767 2.121 2.09 8.64z", fill: "#4dd67b" },
  { d: "m64.455 303.936-3.483-7.537-12.574 5.536 3.483 7.537z", fill: "#d64d5b" },
  { d: "m469.425 188.255-4.196-2.243-3.887 6.571 4.195 2.243zM274.444 79.523l2.578-7.347-19.759-7.827-2.579 7.348z", fill: "#f4dc73" },
  { d: "m106.698 45.185-10.05-4.895-3.424 23.813L103.274 69z", fill: "#177dff" },
  { d: "m625.689 242.803 4.249-3.471-4.338-5.849-4.25 3.471z", fill: "#4dd67b" },
  { d: "m522.602 72-.913-5.76h-15.84l.913 5.76zM894.633 317.899l-8.984-1.946-4.858 16.2 8.984 1.947zM611.051 281.981 607 274.272l-10.794 5.564 4.05 7.709zM1136.7 120.121l-2.44-5.736-8.98.98 2.43 5.736z", fill: "#f4dc73" },
  { d: "m1374.46 175.696 3.6-6.859-19.92-11.16-3.6 6.859z", fill: "#177dff" },
  { d: "m1384.95 279.276-2.52-5.672-8.1 1.5 2.52 5.673z", fill: "#4dd67b" },
  { d: "m1359.66 197.514-1.65-8.43-8.47 1.946 1.64 8.43z", fill: "#177dff" },
  { d: "m582.002 235.911-3.681-8.594-13.14 1.43 3.68 8.594zM683.134 61.632l6.978-2.58-9.562-17.711-6.978 2.58z", fill: "#f4dc73" },
  { d: "m539.593 289.332-7.836.277 2.18 8.656 7.836-.277z", fill: "#d64d5b" },
  { d: "m614.047 236.332 9.448 2.49-5.45-15.922-9.448-2.49z", fill: "#4dd67b" },
  { d: "m1376.73 243.599 5.62-3.722-5.77-9.449-5.63 3.721z", fill: "#f4dc73" },
  { d: "m149.533 68.25-5.898-3.717-6.608 9.899 5.898 3.717z", fill: "#d64d5b" },
  { d: "m888.421 157.196-2.628-6.307-16.401 5.024 2.628 6.306z", fill: "#4dd67b" },
  { d: "m1367.99 178.225-4.87-5.043-5.85 5.445 4.87 5.043z", fill: "#177dff" },
  { d: "m1032.66 127.186-3.46-8.577-20.54 3.014 3.46 8.576zM318.872 290.993l8.902-3.515-8.009-24.091-8.902 3.515z", fill: "#4dd67b" },
  { d: "m1140.11 115.028-4.79-7.489-20.2 14.854 4.79 7.489z", fill: "#177dff" },
  { d: "m596.89 320.228.64-8.795-23.761-3.947-.64 8.795z", fill: "#4dd67b" },
  { d: "m29.085 144.407-1.018-6.859-7.928 2.598 1.017 6.859z", fill: "#177dff" },
  { d: "m359.964 59.343-1.125-5.768-10.638.756 1.126 5.768z", fill: "#f4dc73" },
  { d: "m586.107 172.714-3.134-4.524-8.035 4.61 3.135 4.525z", fill: "#4dd67b" },
  { d: "m394.455 117.103-5.79-.201 3.196 15.869 5.79.201z", fill: "#177dff" },
  { d: "m57.973 245.863-3.706-6.313-12.931 7.348 3.706 6.313z", fill: "#d64d5b" },
  { d: "m128.795 219.413 6.244-.57-3.011-8.692-6.244.571z", fill: "#177dff" },
  { d: "m687.847 317.022-3.923-4.287-5.786 5.307 3.924 4.287z", fill: "#4dd67b" },
  { d: "m923.063 213.311-4.3-3.189-6.068 9.002 4.3 3.189z", fill: "#f4dc73" },
  { d: "m779.135 225.575-4.791-2.434-5.452 8.483 4.791 2.434z", fill: "#d64d5b" },
  { d: "m186.939 212.758-2.661-8.018-10.016-.178 2.661 8.018zM1136.35 283.744l8.56-.907-1.27-12.219-8.56.906zM1086.78 317.746l-1.86-4.981-8.92 1.465 1.85 4.981z", fill: "#4dd67b" },
  { d: "m1335.23 75.377-3.58-2.854-6.15 7.252 3.59 2.854z", fill: "#177dff" },
  { d: "m1436.79 294.135 3.42-5.638-11.56-8.217-3.42 5.637zM615.292 272.642l-5.125-.351 1.387 6.468 5.124.351zM121.182 242.441l3.82-3.509-10.592-11.031-3.821 3.509zM781.152 114.981l6.043-6.392-19.452-18.455-6.043 6.392zM886.9 204.403l6.754-7.081-14-13.258-6.755 7.081z", fill: "#f4dc73" },
  { d: "m746.119 246.875-5.825-5.47-11.85 13.791 5.825 5.47zM1351.47 179.088l4.78-.971-3.44-10.706-4.77.971z", fill: "#d64d5b" },
  { d: "m472.689 133.012-4.629-2.916-6.301 9.47 4.629 2.916zM85.14 37.222l7.835-.694-2.08-20.194-7.836.694z", fill: "#177dff" },
  { d: "m216.02 315.24 5.8-2.749-5.041-10.481-5.801 2.749z", fill: "#f4dc73" },
  { d: "m249.633 100.822 5.957-2.535-6.745-15.929-5.956 2.536z", fill: "#4dd67b" },
  { d: "m1179.66 117.859-9.03-3.665-2.41 18.996 9.04 3.665z", fill: "#d64d5b" },
  { d: "M915.614 65.724 922.282 58l-8.725-7.073-6.668 7.725zM269.075 175.224l.592-5.105-15.46-6.786-.592 5.105z", fill: "#177dff" },
  { d: "m155.776 242.722 3.921-2.799-11.347-11.994-3.922 2.799z", fill: "#4dd67b" },
  { d: "m201.703 88.607-1.634-5.114-14.588-3.46 1.634 5.113zM107.69 299.966l-6.458-3.05-5.666 11.775 6.457 3.05zM1134.53 147.637l-2.14-4.673-5.88 2.428 2.14 4.673z", fill: "#f4dc73" },
  { d: "m659.471 268.619 5.279-1.316-6.169-14.959-5.279 1.315z", fill: "#177dff" },
  { d: "m98.764 92.017-5.887-2.814-2.05 8.882 5.888 2.814z", fill: "#4dd67b" },
  { d: "m1394.34 235.712 8.56-4.103-8.5-18.767-8.56 4.103zM578.862 101.367l-3.052-5.972-16.361 10.453 3.052 5.972z", fill: "#d64d5b" },
  { d: "m903.562 175.133 8.599-.755-1.156-16.537-8.599.755z", fill: "#f4dc73" },
  { d: "m1184.92 279.65-5.63-3.059-6.97 12.785 5.64 3.058z", fill: "#d64d5b" },
  { d: "m1026.46 44.892-8.01-6.537-7.06 9.374 8.01 6.537z", fill: "#4dd67b" },
  { d: "m1410.29 106.724 7.5-1.103-4.75-10.696-7.51 1.102z", fill: "#f4dc73" },
  { d: "m940.145 221.079-5.224-6.341-19.728 17.335 5.224 6.341z", fill: "#4dd67b" },
];

// Animated Confetti - full width with path animations
function AnimatedConfetti({ className }: { className?: string }) {
  const totalPaths = confettiPaths.length;
  const duration = 3; // Total 3 seconds
  const staggerDelay = duration / totalPaths; // Stagger each path

  return (
    <motion.svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 1440 326"
      preserveAspectRatio="xMidYMax slice"
      className={className}
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      transition={{ duration: 0.2 }}
    >
      <g clipPath="url(#confetti-clip)">
        {confettiPaths.map((path, index) => (
          <AnimatedPath
            key={index}
            d={path.d}
            fill={path.fill}
            duration={duration * 0.4}
            delay={index * staggerDelay * 0.3}
          />
        ))}
      </g>
      <defs>
        <clipPath id="confetti-clip">
          <path fill="#fff" d="M0 0h1440v326H0z" />
        </clipPath>
      </defs>
    </motion.svg>
  );
}

export default function Celebrate({ verdict }: { verdict: 'high-score' | 'new-game' | 'default' }) {
  return (
    verdict === 'high-score' ? (
      <AnimatedConfetti className="fixed bottom-0 left-0 w-full h-auto -z-1" />
    ) : (
      <div className="absolute top-0 left-0 w-full h-full select-none pointer-events-none">
        <div className="relative h-full w-full">
          <AnimatedStar2 className="absolute top-1/5 left-6" />
          <AnimatedStar1 className="absolute -bottom-1/5 right-6" />
        </div>
      </div>
    )
  );
}